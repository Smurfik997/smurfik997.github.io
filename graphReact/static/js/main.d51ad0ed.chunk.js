(this.webpackJsonptest=this.webpackJsonptest||[]).push([[0],{14:function(t,e,n){"use strict";n.r(e);var o=n(0),r=n.n(o),a=n(7),c=n.n(a),s=n(6),i=n(1),u=n(2),l=n(4),d=n(3),p=n(5),h=r.a.createContext(),f=function(t){function e(t){var n;return Object(i.a)(this,e),(n=Object(l.a)(this,Object(d.a)(e).call(this,t))).nodeUpdate=function(t,e){n.setState((function(n){return n.nodes[t].left=e[0],n.nodes[t].top=e[1],n}))},n.nodeDelete=function(t){n.setState((function(e){e.edges.forEach((function(n,o){parseInt(n[0])!==t&&parseInt(n[1])!==t||(e.edges[o]=null)}));for(var n=0;n<e.edges.length;)null===e.edges[n]?e.edges.splice(n,1):n++;return e.nodes[t]=null,e.crosshair.display=!1,e}))},n.edgeDelete=function(t){n.setState((function(e){return e.edges.splice(t,1),e}))},n.crosshair=function(t,e,o){n.setState((function(n){return e&&(n.crosshair.left=e),o&&(n.crosshair.top=o),n.crosshair.display=t,n}))},n.paintAlgo=function(){var t=n.state.colorSeed,e=[],o=n.state.nodes.length,r=n.state.edges,a=new Array(o).fill(0);a.forEach((function(t,e){return a[e]=new Array(o)})),r.forEach((function(t){a[t[0]][t[1]]=1,a[t[1]][t[0]]=1})),n.state.nodes.forEach((function(t,n){if(t){e.push(t);for(var r=0,c=0;c<o;c++)1===a[n][c]&&r++;e[e.length-1].color=null,e[e.length-1].index=n,e[e.length-1].n=r}}));for(var c=0;c<e.length;c++){for(var s=c,i=c+1;i<e.length;i++)e[s].n<e[i].n&&(s=i);var u=[e[s],e[c]];e[c]=u[0],e[s]=u[1]}for(var l=1,d=0;d<e.length;){d=0;for(var p=0;p<e.length;p++)if(e[p].color)d++;else{for(var h=!0,f=0;f<e.length;f++)if(e[f].color&&e[f].color===l&&1===a[e[p].index][e[f].index]){h=!1;break}h&&(e[p].color=l)}l++}return e.forEach((function(n,o){e[o].color=[t[0][0]*n.color%t[1]+t[2],t[0][1]*n.color%t[1]+t[2],t[0][2]*n.color%t[1]+t[2]],e[o].textColor=[Math.min(e[o].color[0]+t[3],255),Math.min(e[o].color[1]+t[3],255),Math.min(e[o].color[2]+t[3],255)]})),n.setState({nodes:n.state.nodes}),l-2},n.colorSeedUpdate=function(t){n.setState({colorSeed:t}),n.paintAlgo()},n.drag=function(t,e,o,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],c=document.ontouchend,s=document.ontouchmove;!0!==n.state.mobile&&(e.style.cursor="grabbing");var i=[0,0],u=1;if(!0===n.state.mobile&&(u*=n.state.scale),a&&(i[0]=e.offsetLeft+e.clientWidth/2-.8*u,i[1]=e.offsetTop+e.clientHeight/2-.8*u,n.crosshair(!0,i[0],i[1],e)),!0===n.state.mobile&&t.touches){var l=[t.touches[0].pageX-e.offsetLeft,t.touches[0].pageY-e.offsetTop];document.ontouchend=function(t){a&&n.crosshair(!1),document.removeEventListener("touchmove",d),document.ontouchmove=s,document.ontouchend=c};var d=function(t){t.preventDefault();var c=[t.touches[0].pageX-l[0],t.touches[0].pageY-l[1]];(c[0]<0||c[1]<0)&&"Node"===e.className?(n.nodeDelete(parseInt(e.innerText)),document.ontouchend()):(c[0]<0&&(c[0]=0),c[1]<0&&(c[1]=0),i[0]=c[0]+e.clientWidth/2-.8*u,i[1]=c[1]+e.clientHeight/2-.8*u,a&&n.crosshair(!0,i[0],i[1]),r(o,c))};document.addEventListener("touchmove",d,{passive:!1})}else{var p=[t.pageX-e.offsetLeft,t.pageY-e.offsetTop];document.onmousemove=function(t){var c=[t.pageX-p[0],t.pageY-p[1]];c[0]<0&&(c[0]=0),c[1]<0&&(c[1]=0),i[0]=c[0]+e.clientWidth/2-.8*u,i[1]=c[1]+e.clientHeight/2-.8*u,a&&n.crosshair(!0,i[0],i[1]),r(o,c)},document.onmouseup=function(t){e.style.cursor="grab",a&&n.crosshair(!1),document.onmousemove=function(){},document.onmouseup=function(){}}}},n.state={nodes:[],edges:[],crosshair:{enable:!0,display:!1,top:0,left:0},colorSeed:[[1867,4931,6073],107,130,80],mobile:!1,scale:2.7},n}return Object(p.a)(e,t),Object(u.a)(e,[{key:"addNode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0];this.setState((function(e){return e.nodes.push({left:t[0]>0?t[0]:0,top:t[1]>0?t[1]:0}),e}))}},{key:"addEdge",value:function(t,e){return this.state.nodes[t]&&this.state.nodes[e]&&t!==e?(this.setState((function(n){return n.edges.push([t,e]),n})),"success"):Error("\u0421\u0430\u0448\u0430 \u0418\u0417\u0412\u0418\u041d\u0418")}},{key:"render",value:function(){var t=this;return r.a.createElement(h.Provider,{value:{mobile:this.state.mobile,scale:this.state.scale}},r.a.createElement("div",{id:this.props.DOMElement.Nodes},this.state.nodes.map((function(e,n){return e?r.a.createElement(v,{key:n,index:n,nodes:t.state.nodes,update:t.nodeUpdate,delete:t.nodeDelete,drag:t.drag,color:e.color,textColor:e.textColor}):null}))),r.a.createElement("div",{id:this.props.DOMElement.Edges},this.state.edges.map((function(e,n){return r.a.createElement(g,{key:n,index:n,delete:t.edgeDelete,v1:t.state.nodes[e[0]],v2:t.state.nodes[e[1]]})}))),this.state.crosshair.enable&&this.state.crosshair.display?r.a.createElement(m,{left:this.state.crosshair.left,top:this.state.crosshair.top,target:this.state.crosshair.target}):null)}}]),e}(r.a.Component),v=function(t){function e(t){var n;return Object(i.a)(this,e),(n=Object(l.a)(this,Object(d.a)(e).call(this,t))).drag=function(t){n.props.drag(t,t.target,Object(s.a)(n),(function(t,e){t.props.update(n.props.index,[e[0],e[1]])}),!0)},n}return Object(p.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){var t=this,e=this.props.color,n=this.props.textColor;return r.a.createElement("div",{className:"Node",style:{left:this.props.nodes[this.props.index].left,top:this.props.nodes[this.props.index].top,backgroundColor:e?"rgb(".concat(e[0],", ").concat(e[1],", ").concat(e[2],")"):"",color:n?"rgb(".concat(n[0],", ").concat(n[1],", ").concat(n[2],")"):""},onTouchStart:this.drag,onMouseDown:function(e){t.context.mobile||t.drag(e)},onDoubleClick:function(e){e.preventDefault(),t.props.delete(t.props.index)},tabIndex:"3"},this.props.index)}}]),e}(r.a.Component);v.contextType=h;var g=function(t){function e(t){return Object(i.a)(this,e),Object(l.a)(this,Object(d.a)(e).call(this,t))}return Object(p.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){var t=this,e=[this.props.v1,this.props.v2],n=e[0],o=e[1],a=n.left-o.left,c=n.top-o.top,s=Math.atan(c/a);a>=0&&(s+=Math.PI),s-=Math.PI/2;var i=1;return!0===this.context.mobile&&(i*=this.context.scale),r.a.createElement("div",{className:"Edge",style:{height:Math.sqrt(a*a+c*c),left:n.left+27*i/2-2*Math.cos(s)*i,top:n.top+27*i/2-2*Math.sin(s)*i,transform:"rotate(".concat(s,"rad)")},onDoubleClick:function(){return t.props.delete(t.props.index)}})}}]),e}(r.a.Component);g.contextType=h;var m=function(t){function e(t){return Object(i.a)(this,e),Object(l.a)(this,Object(d.a)(e).call(this,t))}return Object(p.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{id:"crosshairVert",style:{left:this.props.left}}),r.a.createElement("div",{id:"crosshairHorizontal",style:{top:this.props.top}}))}}]),e}(r.a.Component),b=function(t){function e(t){var n;Object(i.a)(this,e),(n=Object(l.a)(this,Object(d.a)(e).call(this,t))).focusOut=function(t,e){t.persist(),t.relatedTarget&&"Node"===t.relatedTarget.className&&(n["v".concat(e)].current.value=t.relatedTarget.innerText)},n.drag=function(t){"INPUT"!==t.target.tagName&&n.props.graph.drag(t,document.querySelector("#edge_bar"),Object(s.a)(n),(function(t,e){t.setState({left:e[0],top:e[1]})}))},n.addEdge=function(t){t.preventDefault(),"success"===n.props.graph.addEdge(n.v1.current.value,n.v2.current.value)||n.state.error||(n.setState({error:!0}),setTimeout((function(){return n.setState({error:!1})}),1e3))};var o=1;return!0===n.props.graph.state.mobile&&(o*=n.props.graph.state.scale),n.state={left:n.props.graph.state.mobile?document.body.clientWidth-130*o:(document.body.clientWidth-120)/2,top:10*o},n.v1=r.a.createRef(),n.v2=r.a.createRef(),n}return Object(p.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){var t=this;return r.a.createElement("div",null,r.a.createElement("form",{onMouseDown:this.drag,onTouchStart:this.drag,onSubmit:function(e){return t.addEdge(e)},id:"edge_bar",style:{left:this.state.left,top:this.state.top}},r.a.createElement("input",{ref:this.v1,placeholder:"0",onFocus:function(){t.v1.current.select(),t.v1.current.setAttribute("tabIndex",1),t.v2.current.setAttribute("tabIndex",2)},onBlur:function(e){return t.focusOut(e,1)},type:"tel"}),r.a.createElement("div",{onClick:function(){var e=[t.v2.current.value,t.v1.current.value];t.v1.current.value=e[0],t.v2.current.value=e[1]}},"+"),r.a.createElement("input",{ref:this.v2,placeholder:"1",onFocus:function(){t.v2.current.select(),t.v2.current.setAttribute("tabIndex",1),t.v1.current.setAttribute("tabIndex",2)},onBlur:function(e){return t.focusOut(e,2)},type:"tel"}),r.a.createElement("button",null,"\u0417'\u0454\u0434\u043d\u0430\u0442\u0438")),this.state.error?r.a.createElement("button",{id:"error",style:this.props.graph.state.mobile?{left:this.state.left,top:this.state.top+256.5}:null},"\u041f\u043e\u043c\u0438\u043b\u043a\u0430"):null)}}]),e}(r.a.Component),y=function(t){function e(t){var n;return Object(i.a)(this,e),(n=Object(l.a)(this,Object(d.a)(e).call(this,t))).drag=function(t,e){n.props.graph.drag(t,t.target,Object(s.a)(n),(function(t,o){n.setState((function(t){return t.buttons[e].left=o[0],t.buttons[e].top=o[1],t}))}))},n.state={buttons:n.props.buttons},n}return Object(p.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){var t=this;return r.a.createElement("div",null,this.state.buttons.map((function(e,n){return!t.props.graph.state.mobile||e.mobile?r.a.createElement("button",{key:n,onMouseDown:function(e){return t.drag(e,n)},onTouchStart:function(e){return t.drag(e,n)},onMouseEnter:function(){return t.setState((function(t){return t.buttons[n].hover=15,t}))},onMouseLeave:function(){return t.setState((function(t){return t.buttons[n].hover=0,t}))},onClick:function(){return e.onClick(t,n)},style:{left:e.left,top:e.top,width:e.width,backgroundColor:"rgb(".concat(e.color[0]-e.hover,",                                    ").concat(e.color[1]-e.hover,",                                    ").concat(e.color[2]-e.hover,")")}},e.caption):null})))}}]),e}(r.a.Component),E=c.a.render(r.a.createElement(f,{DOMElement:{Nodes:"node_container",Edges:"edge_container"}}),document.querySelector("#graph_container"));window.navigator.maxTouchPoints>0&&(document.querySelector("#graph_container").setAttribute("mobile",!0),document.querySelector("#edge_bar_container").setAttribute("mobile",!0),document.querySelector("#buttons_container").setAttribute("mobile",!0),document.querySelector("#copyright").setAttribute("mobile",!0),E.setState({mobile:!0}));var O=1;!0===E.state.mobile&&(O*=E.state.scale);var x;c.a.render(r.a.createElement(b,{graph:E}),document.querySelector("#edge_bar_container")),c.a.render(r.a.createElement(y,{graph:E,buttons:[{id:"paintButton",color:[140,130,210],caption:"\u0424\u0430\u0440\u0431\u0443\u0432\u0430\u0442\u0438",onClick:E.paintAlgo,width:120*O,top:10*O,left:10*O,hover:0,mobile:!0},{id:"gridButton",color:[210,110,230],caption:"\u0423\u0432\u0456\u043c\u043a\u043d\u0443\u0442\u0438 \u0441\u0456\u0442\u043a\u0443",captionActive:"\u0412\u0438\u043c\u043a\u043d\u0443\u0442\u0438 \u0441\u0456\u0442\u043a\u0443",active:!1,onClick:function(t,e){t.setState((function(t){var n=t.buttons[e];n.active=!n.active,n.active?document.body.style="background: linear-gradient(rgb(230, 230, 230) 10%, transparent 0%),                    linear-gradient(90deg, rgb(230, 230, 230) 10%, transparent 0%);                    background-size: 1px 16px, 16px 1px;                    background-position: -1.6px -1.6px":document.body.style="background: 0";var o=[n.captionActive,n.caption];return n.caption=o[0],n.captionActive=o[1],t}))},width:150,top:10,left:140,hover:0,mobile:!1}]}),document.querySelector("#buttons_container"));document.onmousedown=function(t){!0===t.altKey&&E.addNode([t.pageX-27*O/2,t.pageY-27*O/2])},document.ondblclick=function(t){t.preventDefault(),t.target===document.body&&E.addNode([t.pageX-27*O/2,t.pageY-27*O/2])},document.ontouchstart=function(t){"BODY"===t.target.tagName&&1===t.touches.length&&(x=setTimeout((function(){E.addNode([t.touches[0].pageX-27*O/2,t.touches[0].pageY-27*O/2])}),300)),"Edge"===t.target.className&&1===t.touches.length&&(x=setTimeout((function(){var e=document.createEvent("Events");e.initEvent("dblclick",!0,!1),t.target.dispatchEvent(e)}),300))},document.ontouchmove=function(t){clearTimeout(x)},document.ontouchend=function(t){clearTimeout(x)}},9:function(t,e,n){t.exports=n(14)}},[[9,1,2]]]);
//# sourceMappingURL=main.d51ad0ed.chunk.js.map