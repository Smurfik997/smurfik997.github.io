(this.webpackJsonptest=this.webpackJsonptest||[]).push([[0],{14:function(e,t,o){"use strict";o.r(t);var n=o(0),r=o.n(n),a=o(7),c=o.n(a),s=o(6),i=o(1),u=o(2),l=o(4),d=o(3),h=o(5),p=r.a.createContext(),f=function(e){function t(e){var o;return Object(i.a)(this,t),(o=Object(l.a)(this,Object(d.a)(t).call(this,e))).nodeUpdate=function(e,t){o.setState((function(o){return o.nodes[e].left=t[0],o.nodes[e].top=t[1],o}))},o.nodeDelete=function(e){o.setState((function(t){t.edges.forEach((function(o,n){o[0]!==e&&o[1]!==e||(t.edges[n]=null)}));for(var o=0;o<t.edges.length;)null===t.edges[o]?t.edges.splice(o,1):o++;return t.nodes[e]=null,t.crosshair.display=!1,t}))},o.edgeDelete=function(e){o.setState((function(t){return t.edges.splice(e,1),t}))},o.crosshair=function(e,t,n){o.setState((function(o){return t&&(o.crosshair.left=t),n&&(o.crosshair.top=n),o.crosshair.display=e,o}))},o.paintAlgo=function(){var e=o.state.colorSeed,t=[],n=o.state.nodes.length,r=o.state.edges,a=new Array(n).fill(0);a.forEach((function(e,t){return a[t]=new Array(n)})),r.forEach((function(e){a[e[0]][e[1]]=1,a[e[1]][e[0]]=1})),o.state.nodes.forEach((function(e,o){if(e){t.push(e);for(var r=0,c=0;c<n;c++)1===a[o][c]&&r++;t[t.length-1].color=null,t[t.length-1].index=o,t[t.length-1].n=r}}));for(var c=0;c<t.length;c++){for(var s=c,i=c+1;i<t.length;i++)t[s].n<t[i].n&&(s=i);var u=[t[s],t[c]];t[c]=u[0],t[s]=u[1]}for(var l=1,d=0;d<t.length;){d=0;for(var h=0;h<t.length;h++)if(t[h].color)d++;else{for(var p=!0,f=0;f<t.length;f++)if(t[f].color&&t[f].color===l&&1===a[t[h].index][t[f].index]){p=!1;break}p&&(t[h].color=l)}l++}return t.forEach((function(o,n){t[n].color=[e[0][0]*o.color%e[1]+e[2],e[0][1]*o.color%e[1]+e[2],e[0][2]*o.color%e[1]+e[2]],t[n].textColor=[Math.min(t[n].color[0]+e[3],255),Math.min(t[n].color[1]+e[3],255),Math.min(t[n].color[2]+e[3],255)]})),o.setState({nodes:o.state.nodes}),l-2},o.colorSeedUpdate=function(e){o.setState({colorSeed:e}),o.paintAlgo()},o.drag=function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],c=document.ontouchend;!0!==o.state.mobile&&(t.style.cursor="grabbing");var s=[0,0],i=1;if(!0===o.state.mobile&&(i*=o.state.scale),a&&(s[0]=t.offsetLeft+t.clientWidth/2-.8*i,s[1]=t.offsetTop+t.clientHeight/2-.8*i,o.crosshair(!0,s[0],s[1],t)),!0===o.state.mobile){var u=[e.touches[0].pageX-t.offsetLeft,e.touches[0].pageY-t.offsetTop];document.ontouchmove=function(e){e.preventDefault();var c=[e.touches[0].pageX-u[0],e.touches[0].pageY-u[1]];c[0]<0&&(c[0]=0),c[1]<0&&(c[1]=0),s[0]=c[0]+t.clientWidth/2-.8*i,s[1]=c[1]+t.clientHeight/2-.8*i,a&&o.crosshair(!0,s[0],s[1]),r(n,c)},document.ontouchend=function(e){a&&o.crosshair(!1),document.ontouchmove=function(){},document.ontouchend=c}}else{var l=[e.pageX-t.offsetLeft,e.pageY-t.offsetTop];document.onmousemove=function(e){var c=[e.pageX-l[0],e.pageY-l[1]];c[0]<0&&(c[0]=0),c[1]<0&&(c[1]=0),s[0]=c[0]+t.clientWidth/2-.8*i,s[1]=c[1]+t.clientHeight/2-.8*i,a&&o.crosshair(!0,s[0],s[1]),r(n,c)},document.onmouseup=function(e){t.style.cursor="grab",a&&o.crosshair(!1),document.onmousemove=function(){},document.onmouseup=function(){}}}},o.state={nodes:[],edges:[],crosshair:{enable:!0,display:!1,top:0,left:0},colorSeed:[[1867,4931,6073],131,110,80],mobile:!1,scale:2.7},o}return Object(h.a)(t,e),Object(u.a)(t,[{key:"addNode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0];this.setState((function(t){return t.nodes.push({left:e[0]>0?e[0]:0,top:e[1]>0?e[1]:0}),t}))}},{key:"addEdge",value:function(e,t){if(this.state.nodes[e]&&this.state.nodes[t]&&e!==t)return this.setState((function(o){return o.edges.push([e,t]),o})),"success";throw Error("\u0421\u0430\u0448\u0430 \u0418\u0417\u0412\u0418\u041d\u0418")}},{key:"render",value:function(){var e=this;return r.a.createElement(p.Provider,{value:{mobile:this.state.mobile,scale:this.state.scale}},r.a.createElement("div",{id:this.props.DOMElement.Nodes},this.state.nodes.map((function(t,o){return t?r.a.createElement(g,{key:o,index:o,nodes:e.state.nodes,update:e.nodeUpdate,delete:e.nodeDelete,drag:e.drag,color:t.color,textColor:t.textColor}):null}))),r.a.createElement("div",{id:this.props.DOMElement.Edges},this.state.edges.map((function(t,o){return r.a.createElement(m,{key:o,index:o,delete:e.edgeDelete,v1:e.state.nodes[t[0]],v2:e.state.nodes[t[1]]})}))),this.state.crosshair.enable&&this.state.crosshair.display?r.a.createElement(b,{left:this.state.crosshair.left,top:this.state.crosshair.top,target:this.state.crosshair.target}):null)}}]),t}(r.a.Component),g=function(e){function t(e){var o;return Object(i.a)(this,t),(o=Object(l.a)(this,Object(d.a)(t).call(this,e))).drag=function(e){o.props.drag(e,e.target,Object(s.a)(o),(function(e,t){e.props.update(o.props.index,[t[0],t[1]])}),!0)},o}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.props.color,o=this.props.textColor;return r.a.createElement("button",{className:"Node",style:{left:this.props.nodes[this.props.index].left,top:this.props.nodes[this.props.index].top,backgroundColor:t?"rgb(".concat(t[0],", ").concat(t[1],", ").concat(t[2],")"):"",color:o?"rgb(".concat(o[0],", ").concat(o[1],", ").concat(o[2],")"):""},onTouchStart:this.drag,onMouseDown:this.drag,onDoubleClick:function(t){t.preventDefault(),console.log("dd"),e.props.delete(e.props.index)}},this.props.index)}}]),t}(r.a.Component),m=function(e){function t(e){return Object(i.a)(this,t),Object(l.a)(this,Object(d.a)(t).call(this,e))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=[this.props.v1,this.props.v2],o=t[0],n=t[1],a=o.left-n.left,c=o.top-n.top,s=Math.atan(c/a);a>=0&&(s+=Math.PI),s-=Math.PI/2;var i=1;return!0===this.context.mobile&&(i*=this.context.scale),r.a.createElement("div",{className:"Edge",style:{height:Math.sqrt(a*a+c*c),left:o.left+27*i/2-2*Math.cos(s)*i,top:o.top+27*i/2-2*Math.sin(s)*i,transform:"rotate(".concat(s,"rad)")},onDoubleClick:function(){return e.props.delete(e.props.index)}})}}]),t}(r.a.Component);m.contextType=p;var b=function(e){function t(e){return Object(i.a)(this,t),Object(l.a)(this,Object(d.a)(t).call(this,e))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{id:"crosshairVert",style:{left:this.props.left}}),r.a.createElement("div",{id:"crosshairHorizontal",style:{top:this.props.top}}))}}]),t}(r.a.Component),v=function(e){function t(e){var o;Object(i.a)(this,t),(o=Object(l.a)(this,Object(d.a)(t).call(this,e))).focusOut=function(e,t){e.persist(),e.relatedTarget&&"Node"===e.relatedTarget.className&&(o["v".concat(t)].current.value=e.relatedTarget.innerText)},o.drag=function(e){"INPUT"!==e.target.tagName&&o.props.graph.drag(e,document.querySelector("#edge_bar"),Object(s.a)(o),(function(e,t){e.setState({left:t[0],top:t[1]})}))},o.addEdge=function(e){e.preventDefault();o.props.graph.addEdge(o.v1.current.value,o.v2.current.value)};var n=1;return!0===o.props.graph.state.mobile&&(n*=o.props.graph.state.scale),o.state={left:o.props.graph.state.mobile?document.body.clientWidth-130*n:(document.body.clientWidth-120)/2,top:10*n},o.v1=r.a.createRef(),o.v2=r.a.createRef(),o}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("form",{onMouseDown:this.drag,onTouchStart:this.drag,onSubmit:function(t){return e.addEdge(t)},id:"edge_bar",style:{left:this.state.left,top:this.state.top}},r.a.createElement("input",{ref:this.v1,placeholder:"0",onFocus:function(){e.v1.current.select(),e.v1.current.setAttribute("tabIndex",1),e.v2.current.setAttribute("tabIndex",2)},onBlur:function(t){return e.focusOut(t,1)}}),r.a.createElement("div",{onClick:function(){var t=[e.v2.current.value,e.v1.current.value];e.v1.current.value=t[0],e.v2.current.value=t[1]}},"+"),r.a.createElement("input",{ref:this.v2,placeholder:"1",onFocus:function(){e.v2.current.select(),e.v2.current.setAttribute("tabIndex",1),e.v1.current.setAttribute("tabIndex",2)},onBlur:function(t){return e.focusOut(t,2)}}),r.a.createElement("button",null,"\u0417'\u0454\u0434\u043d\u0430\u0442\u0438"))}}]),t}(r.a.Component),O=function(e){function t(e){var o;Object(i.a)(this,t),(o=Object(l.a)(this,Object(d.a)(t).call(this,e))).drag=function(e){o.props.graph.drag(e,e.target,Object(s.a)(o),(function(e,t){o.setState({left:t[0],top:t[1]})}))};var n=1;return!0===o.props.graph.state.mobile&&(n*=o.props.graph.state.scale),o.state={left:10*n,top:10*n},o}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("button",{onMouseDown:this.drag,onTouchStart:this.drag,onClick:this.props.graph.paintAlgo,style:{left:this.state.left,top:this.state.top}},"\u0424\u0430\u0440\u0431\u0443\u0432\u0430\u0442\u0438")}}]),t}(r.a.Component),y=c.a.render(r.a.createElement(f,{DOMElement:{Nodes:"node_container",Edges:"edge_container"}}),document.querySelector("#graph_container"));window.navigator.maxTouchPoints>0&&(document.querySelector("#graph_container").setAttribute("mobile",!0),document.querySelector("#edge_bar_container").setAttribute("mobile",!0),document.querySelector("#paint_button").setAttribute("mobile",!0),document.querySelector("#copyright").setAttribute("mobile",!0),y.setState({mobile:!0}));c.a.render(r.a.createElement(v,{graph:y}),document.querySelector("#edge_bar_container")),c.a.render(r.a.createElement(O,{graph:y}),document.querySelector("#paint_button"));var E,j=1;!0===y.state.mobile&&(j*=y.state.scale),document.onmousedown=function(e){!0===e.altKey&&y.addNode([e.pageX-27*j/2,e.pageY-27*j/2])},document.ondblclick=function(e){e.preventDefault(),e.target===document.body&&y.addNode([e.pageX-27*j/2,e.pageY-27*j/2])},document.ontouchstart=function(e){"BODY"===e.target.tagName&&(E=setTimeout((function(){y.addNode([e.touches[0].pageX-27*j/2,e.touches[0].pageY-27*j/2])}),250))},document.ontouchend=function(e){clearTimeout(E)}},9:function(e,t,o){e.exports=o(14)}},[[9,1,2]]]);
//# sourceMappingURL=main.e2ade509.chunk.js.map